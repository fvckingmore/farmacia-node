<%- include('../layouts/head'); %>
<%- include('../layouts/sidebar'); %>

<div id="page-wrapper">
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-12">
				<h2 class="page-header"><%=titulo%></h2>

				<%if(locals.creado == 1){%>
					<%-include('../layouts/alert', {"status": "success", "mensaje": "Empleado creado correctamente"});%>
				<%}else if(locals.creado == 0){%>
					<%-include('../layouts/alert', {"status": "danger", "mensaje": "Error al crear Empleado"});%>
				<%}else if(locals.editado == 1){%>
					<%-include('../layouts/alert', {"status": "success", "mensaje": "Empleado editado correctamente"});%>
				<%}else if(locals.editado == 0){%>
					<%-include('../layouts/alert', {"status": "danger", "mensaje": "Error al editar Empleado"});%>
				<%}else if(locals.eliminado == 1){%>
					<%-include('../layouts/alert', {"status": "success", "mensaje": "Empleado eliminado correctamente"});%>
				<%}else if(locals.eliminado == 0){%>
					<%-include('../layouts/alert', {"status": "danger", "mensaje": "Error al eliminar farmacia"});%>
				<%}%>

				<div class="text-right">
					<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter"><i class="fa fa-plus"></i></button>
				</div>
			</div>
			<!-- /.col-lg-12 -->
		</div>
		<!-- /.row -->
		<div class="row">
			<div class="col-lg-12">
				<div class="panel panel-default">
					<!-- /.panel-heading -->
					<div class="panel-body">
						<div class="table-responsive">
							<table class="table table-striped table-bordered table-hover" id="dataTables-example">
								<thead class="text-center">
									<tr>
										<th>ID</th>
										<th>Farmacia</th>
										<th>Laboratorio</th>
										<th>Forma Pago</th>
										<th>Accion</th>
									</tr>
								</thead>

								<tbody class="text-center">
									<% locals.pedidos.forEach((p) => { %>
									<tr>
										<td><%=p.id%></td>
										<td><%=p.farmacia.nombre%></td>
										<td><%=p.laboratorio.nombre%></td>
										<td><%=p.formas_pago.descripcion%></td>
										<td >
											<a href="/pedido/edit/<%=p.id%>" class="btn btn-warning"><i class="fa fa-edit"></i></a>
											<a href="/pedido/show/<%=p.id%>" class="btn btn-success"><i class="fa fa-user"></i></a>
											<button type="submit" form="theForm" class="btn btn-danger"><i class="fa fa-trash"></i></button>
											<form id="theForm" action="/pedido/delete/<%=p.id%>" method="POST"></form>
										</td>
									</tr>
									<%});%>

								</tbody>
							</table>
						</div>
					</div>
					<!-- /.panel-body -->
				</div>
				<!-- /.panel -->
			</div>
			<!-- /.col-lg-12 -->
		</div>
	</div>
	<!-- /.container-fluid -->
</div>
<!-- /#page-wrapper -->

<%- include('./modal'); %>
<%- include('../layouts/scripts'); %>
<%- include('../layouts/datatable'); %>
<%- include('../pedido/validation'); %>

<script type="text/javascript">
$(document).ready(function(){
    var maxField = 10; //Input fields increment limitation
    var addButton = $('.add_button'); //Add button selector
    var wrapper = $('.field_wrapper'); //Input field wrapper
    // var fieldHTML = '<div class="form-group"><input class="form-control" type="text" name="medicamentos[]"><a href="javascript:void(0);" class="btn btn-danger remove_button">X</a></div>'; //New input field html 
    var fieldHTML = '<div class="form-group"> <select name="medicamentos" class="form-control"> <option value="">Elija un medicamento...</option> <%medicamentos.forEach(m => {%> <option value="<%=m.id%>"><%=m.monodroga%></option> <%});%> </select> </div>'; //New input field html 
    var x = 1; //Initial field counter is 1
    
    //Once add button is clicked
    $(addButton).click(function(){
            $(wrapper).append(fieldHTML); //Add field html
    });
    
    //Once remove button is clicked
    $(wrapper).on('click', '.remove_button', function(e){
        e.preventDefault();
        $(this).parent('div').remove(); //Remove field html
    });
});
</script>

<%if(locals.edit || locals.show){%>
	<script type="text/javascript">
		$("#exampleModalCenter").modal('show');
	</script>
<%}%>

<%- include('../layouts/foot'); %>