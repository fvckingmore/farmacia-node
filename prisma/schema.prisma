// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
	provider = "prisma-client-js"
}

datasource db {
	provider = "postgresql"
	url      = env("DATABASE_URL")
}

model Cargo {
	id Int @id @default(autoincrement())
	descripcion String
	empleados Empleado[]
	@@map("cargos")
}

model FormaPago {
	id Int @id @default(autoincrement())
	descripcion String
	pedidos Pedido[]
	@@map("formas_pago")
}

model Farmacia {
	id Int @id @default(autoincrement())
	nombre String
	ubicacion String

	empleados Empleado[]
	inventarios Inventario[]
	pedidos Pedido[]
	compras Compra[]
	@@map("farmacias")
}

model Empleado {
	id Int @id @default(autoincrement())
	ci String
	nombre String
	apellido String
	edad Int
	telefono String?
	id_cargo Int
	id_farmacia Int

	cargo Cargo @relation(fields: [id_cargo], references: [id])
	farmacia Farmacia @relation(fields: [id_farmacia], references: [id]) 
	@@map("empleados")
}

model Medicamento {
	id Int @id @default(autoincrement())
	monodroga String
	presentacion String
	accion String
	precio Float

	compras CompraMedicamento[]
	laboratorios LaboratorioMedicamento[]
	pedidos PedidoMedicamento[]
	inventarios Inventario[]
	@@map("medicamentos")
}

model Pedido {
	id Int @id @default(autoincrement())
	id_farmacia Int
	id_laboratorio Int
	forma_pago Int
	slug String

	farmacia Farmacia @relation(fields: [id_farmacia], references: [id]) 
	laboratorio Laboratorio @relation(fields: [id_laboratorio], references: [id]) 
	formas_pago FormaPago @relation(fields: [forma_pago], references: [id]) 
	compras Compra?
	medicamentos PedidoMedicamento[]
	@@map("pedidos")
}

model Compra {
	id Int @id @default(autoincrement())
	vencimiento DateTime 
	cancelado Boolean
	id_farmacia Int
	id_pedido Int @unique

	medicamentos CompraMedicamento[]
	farmacia Farmacia @relation(fields: [id_farmacia], references: [id]) 
	pedido Pedido @relation(fields: [id_pedido], references: [id]) 
	@@map("compras")
}

model Inventario {
	id Int @id @default(autoincrement())
	id_farmacia Int
	id_medicamento Int
	cantidad Int

	farmacia Farmacia @relation(fields: [id_farmacia], references: [id]) 
	medicamento Medicamento @relation(fields: [id_medicamento], references: [id]) 
	@@map("inventario")
}

model Laboratorio {
	id Int @id @default(autoincrement())
	nombre String
	direccion String
	telefono String

	medicamentos LaboratorioMedicamento[]
	pedidos Pedido[]
	@@map("laboratorios")
}

model CompraMedicamento {
	id Int @id @default(autoincrement())
	id_compra Int
	id_medicamento Int
	cantidad Int

	medicamento Medicamento @relation(fields: [id_medicamento], references: [id])
	compra Compra @relation(fields: [id_compra], references: [id])
	@@map("compra_medicamento")
}

model LaboratorioMedicamento {
	id Int @id @default(autoincrement())
	id_laboratorio Int
	id_medicamento Int

	medicamento Medicamento @relation(fields: [id_medicamento], references: [id])
	laboratorio Laboratorio @relation(fields: [id_laboratorio], references: [id])
	@@map("laboratorio_medicamento")
}

model PedidoMedicamento {
	id Int @id @default(autoincrement())
	id_pedido Int
	id_medicamento Int
	cantidad Int

	medicamento Medicamento @relation(fields: [id_medicamento], references: [id])
	pedido Pedido @relation(fields: [id_pedido], references: [id])
	@@map("pedido_medicamento")
}